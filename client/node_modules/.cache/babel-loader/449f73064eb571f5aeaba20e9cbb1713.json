{"ast":null,"code":"// environment configutations\nimport ENV from'./../config.js';var API_HOST=ENV.api_host;// Send a request to check if a user is logged in through the session cookie\nexport var checkSession=function checkSession(app){var url=\"\".concat(API_HOST,\"/users/check-session\");if(!ENV.use_frontend_test_user){fetch(url).then(function(res){if(res.status===200){return res.json();}}).then(function(json){if(json&&json.currentUser){app.setState({currentUser:json.currentUser});}}).catch(function(error){console.log(error);});}else{app.setState({currentUser:ENV.user});}};// A function to send a POST request with the user to be logged in\nexport var login=function login(loginComp,app){var request=new Request(\"\".concat(API_HOST,\"/users/login\"),{method:\"post\",body:JSON.stringify(loginComp.state),headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"}});return fetch(request).then(function(res){if(res.status===200){return res.json();}}).then(function(json){console.log(json);if(json.currentUser){app.setState({currentUser:json.currentUser,admin:json.admin});loginComp.setState({loggedIn:1});}}).catch(function(error){console.log(error);return\"fail\";});};// Log out user and destroy session\nexport var logoutUser=function logoutUser(app){var url=\"\".concat(API_HOST,\"/users/logout\");return fetch(url).then(function(res){app.setState({currentUser:null,admin:\"false\"});}).catch(function(error){console.log(error);});};","map":{"version":3,"sources":["/Users/valeriewirianto/University Stuff/309/Group/team50/client/src/actions/session.js"],"names":["ENV","API_HOST","api_host","checkSession","app","url","use_frontend_test_user","fetch","then","res","status","json","currentUser","setState","catch","error","console","log","user","login","loginComp","request","Request","method","body","JSON","stringify","state","headers","Accept","admin","loggedIn","logoutUser"],"mappings":"AAAA;AACA,MAAOA,CAAAA,GAAP,KAAgB,gBAAhB,CACA,GAAMC,CAAAA,QAAQ,CAAGD,GAAG,CAACE,QAArB,CAEA;AACA,MAAO,IAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,GAAD,CAAS,CACjC,GAAMC,CAAAA,GAAG,WAAMJ,QAAN,wBAAT,CAEA,GAAI,CAACD,GAAG,CAACM,sBAAT,CAAiC,CAC7BC,KAAK,CAACF,GAAD,CAAL,CACCG,IADD,CACM,SAAAC,GAAG,CAAI,CACT,GAAIA,GAAG,CAACC,MAAJ,GAAe,GAAnB,CAAwB,CACpB,MAAOD,CAAAA,GAAG,CAACE,IAAJ,EAAP,CACH,CACJ,CALD,EAMCH,IAND,CAMM,SAAAG,IAAI,CAAI,CACV,GAAIA,IAAI,EAAIA,IAAI,CAACC,WAAjB,CAA8B,CAC1BR,GAAG,CAACS,QAAJ,CAAa,CAAED,WAAW,CAAED,IAAI,CAACC,WAApB,CAAb,EACH,CACJ,CAVD,EAWCE,KAXD,CAWO,SAAAC,KAAK,CAAI,CACZC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACH,CAbD,EAcH,CAfD,IAeO,CACHX,GAAG,CAACS,QAAJ,CAAa,CAAED,WAAW,CAAEZ,GAAG,CAACkB,IAAnB,CAAb,EACH,CAEJ,CAtBM,CAwBP;AACA,MAAO,IAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACC,SAAD,CAAYhB,GAAZ,CAAoB,CACrC,GAAMiB,CAAAA,OAAO,CAAG,GAAIC,CAAAA,OAAJ,WAAerB,QAAf,iBAAuC,CACnDsB,MAAM,CAAE,MAD2C,CAEnDC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeN,SAAS,CAACO,KAAzB,CAF6C,CAGnDC,OAAO,CAAE,CACLC,MAAM,CAAE,mCADH,CAEL,eAAgB,kBAFX,CAH0C,CAAvC,CAAhB,CASA,MAAOtB,CAAAA,KAAK,CAACc,OAAD,CAAL,CACFb,IADE,CACG,SAAAC,GAAG,CAAI,CACT,GAAIA,GAAG,CAACC,MAAJ,GAAe,GAAnB,CAAwB,CACpB,MAAOD,CAAAA,GAAG,CAACE,IAAJ,EAAP,CACH,CACJ,CALE,EAMFH,IANE,CAMG,SAAAG,IAAI,CAAI,CACVK,OAAO,CAACC,GAAR,CAAYN,IAAZ,EACA,GAAIA,IAAI,CAACC,WAAT,CAAsB,CAClBR,GAAG,CAACS,QAAJ,CAAa,CAAED,WAAW,CAAED,IAAI,CAACC,WAApB,CAAiCkB,KAAK,CAAEnB,IAAI,CAACmB,KAA7C,CAAb,EACAV,SAAS,CAACP,QAAV,CAAmB,CAAEkB,QAAQ,CAAE,CAAZ,CAAnB,EACH,CACJ,CAZE,EAaFjB,KAbE,CAaI,SAAAC,KAAK,CAAI,CACZC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACA,MAAO,MAAP,CACH,CAhBE,CAAP,CAiBH,CA3BM,CA+BP;AACA,MAAO,IAAMiB,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAAC5B,GAAD,CAAS,CAC/B,GAAMC,CAAAA,GAAG,WAAMJ,QAAN,iBAAT,CACI,MAAOM,CAAAA,KAAK,CAACF,GAAD,CAAL,CACNG,IADM,CACD,SAAAC,GAAG,CAAI,CACTL,GAAG,CAACS,QAAJ,CAAa,CACTD,WAAW,CAAE,IADJ,CAETkB,KAAK,CAAE,OAFE,CAAb,EAIH,CANM,EAONhB,KAPM,CAOA,SAAAC,KAAK,CAAI,CACZC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACH,CATM,CAAP,CAYP,CAdM","sourcesContent":["// environment configutations\nimport ENV from './../config.js'\nconst API_HOST = ENV.api_host\n\n// Send a request to check if a user is logged in through the session cookie\nexport const checkSession = (app) => {\n    const url = `${API_HOST}/users/check-session`;\n\n    if (!ENV.use_frontend_test_user) {\n        fetch(url)\n        .then(res => {\n            if (res.status === 200) {\n                return res.json();\n            }\n        })\n        .then(json => {\n            if (json && json.currentUser) {\n                app.setState({ currentUser: json.currentUser });\n            }\n        })\n        .catch(error => {\n            console.log(error);\n        });\n    } else {\n        app.setState({ currentUser: ENV.user });\n    }\n    \n};\n\n// A function to send a POST request with the user to be logged in\nexport const login = (loginComp, app) => {\n    const request = new Request(`${API_HOST}/users/login`, {\n        method: \"post\",\n        body: JSON.stringify(loginComp.state),\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    });\n\n    return fetch(request)\n        .then(res => {\n            if (res.status === 200) {\n                return res.json();\n            }\n        })\n        .then(json => {\n            console.log(json)\n            if (json.currentUser) {\n                app.setState({ currentUser: json.currentUser, admin: json.admin });\n                loginComp.setState({ loggedIn: 1 })\n            }\n        })\n        .catch(error => {\n            console.log(error)\n            return \"fail\"\n        });\n};\n\n\n\n// Log out user and destroy session\nexport const logoutUser = (app) => {\n    const url = `${API_HOST}/users/logout`;\n        return fetch(url)\n        .then(res => {\n            app.setState({\n                currentUser: null,\n                admin: \"false\"\n            })\n        })\n        .catch(error => {\n            console.log(error);\n        });\n    \n    \n};"]},"metadata":{},"sourceType":"module"}