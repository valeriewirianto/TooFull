{"ast":null,"code":"// environment configutations\nimport ENV from './../config.js';\nconst API_HOST = ENV.api_host; // Send a request to check if a user is logged in through the session cookie\n\nexport const checkSession = app => {\n  const url = `${API_HOST}/users/check-session`;\n\n  if (!ENV.use_frontend_test_user) {\n    fetch(url).then(res => {\n      if (res.status === 200) {\n        return res.json();\n      }\n    }).then(json => {\n      if (json && json.currentUser) {\n        app.setState({\n          currentUser: json.currentUser\n        });\n      }\n    }).catch(error => {\n      console.log(error);\n    });\n  } else {\n    app.setState({\n      currentUser: ENV.user\n    });\n  }\n}; // A function to send a POST request with the user to be logged in\n\nexport const login = (loginComp, app) => {\n  const request = new Request(`${API_HOST}/users/login`, {\n    method: \"post\",\n    body: JSON.stringify(loginComp.state),\n    headers: {\n      Accept: \"application/json, text/plain, */*\",\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  return fetch(request).then(res => {\n    console.log(res);\n\n    if (res.status === 200) {\n      return res.json();\n    }\n  }).then(json => {\n    if (json && json.currentUser) {\n      app.setState({\n        currentUser: json.currentUser,\n        admin: json.admin\n      });\n      loginComp.setState({\n        loggedIn: 1\n      });\n      return \"success\";\n    }\n  }).catch(error => {\n    console.log(error);\n  });\n}; // Log out user and destroy session\n\nexport const logoutUser = app => {\n  const url = `${API_HOST}/users/logout`;\n  return fetch(url).then(res => {\n    app.setState({\n      currentUser: null,\n      admin: \"false\"\n    });\n  }).catch(error => {\n    console.log(error);\n  });\n};","map":{"version":3,"sources":["/Users/valeriewirianto/University Stuff/309/Group/team50/client/src/actions/session.js"],"names":["ENV","API_HOST","api_host","checkSession","app","url","use_frontend_test_user","fetch","then","res","status","json","currentUser","setState","catch","error","console","log","user","login","loginComp","request","Request","method","body","JSON","stringify","state","headers","Accept","admin","loggedIn","logoutUser"],"mappings":"AAAA;AACA,OAAOA,GAAP,MAAgB,gBAAhB;AACA,MAAMC,QAAQ,GAAGD,GAAG,CAACE,QAArB,C,CAEA;;AACA,OAAO,MAAMC,YAAY,GAAIC,GAAD,IAAS;AACjC,QAAMC,GAAG,GAAI,GAAEJ,QAAS,sBAAxB;;AAEA,MAAI,CAACD,GAAG,CAACM,sBAAT,EAAiC;AAC7BC,IAAAA,KAAK,CAACF,GAAD,CAAL,CACCG,IADD,CACMC,GAAG,IAAI;AACT,UAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB;AACpB,eAAOD,GAAG,CAACE,IAAJ,EAAP;AACH;AACJ,KALD,EAMCH,IAND,CAMMG,IAAI,IAAI;AACV,UAAIA,IAAI,IAAIA,IAAI,CAACC,WAAjB,EAA8B;AAC1BR,QAAAA,GAAG,CAACS,QAAJ,CAAa;AAAED,UAAAA,WAAW,EAAED,IAAI,CAACC;AAApB,SAAb;AACH;AACJ,KAVD,EAWCE,KAXD,CAWOC,KAAK,IAAI;AACZC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACH,KAbD;AAcH,GAfD,MAeO;AACHX,IAAAA,GAAG,CAACS,QAAJ,CAAa;AAAED,MAAAA,WAAW,EAAEZ,GAAG,CAACkB;AAAnB,KAAb;AACH;AAEJ,CAtBM,C,CAwBP;;AACA,OAAO,MAAMC,KAAK,GAAG,CAACC,SAAD,EAAYhB,GAAZ,KAAoB;AACrC,QAAMiB,OAAO,GAAG,IAAIC,OAAJ,CAAa,GAAErB,QAAS,cAAxB,EAAuC;AACnDsB,IAAAA,MAAM,EAAE,MAD2C;AAEnDC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeN,SAAS,CAACO,KAAzB,CAF6C;AAGnDC,IAAAA,OAAO,EAAE;AACLC,MAAAA,MAAM,EAAE,mCADH;AAEL,sBAAgB;AAFX;AAH0C,GAAvC,CAAhB;AASA,SAAOtB,KAAK,CAACc,OAAD,CAAL,CACFb,IADE,CACGC,GAAG,IAAI;AACTO,IAAAA,OAAO,CAACC,GAAR,CAAYR,GAAZ;;AACA,QAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB;AACpB,aAAOD,GAAG,CAACE,IAAJ,EAAP;AACH;AACJ,GANE,EAOFH,IAPE,CAOGG,IAAI,IAAI;AACV,QAAIA,IAAI,IAAIA,IAAI,CAACC,WAAjB,EAA8B;AAC1BR,MAAAA,GAAG,CAACS,QAAJ,CAAa;AAAED,QAAAA,WAAW,EAAED,IAAI,CAACC,WAApB;AAAiCkB,QAAAA,KAAK,EAAEnB,IAAI,CAACmB;AAA7C,OAAb;AACAV,MAAAA,SAAS,CAACP,QAAV,CAAmB;AAAEkB,QAAAA,QAAQ,EAAE;AAAZ,OAAnB;AACA,aAAO,SAAP;AACH;AACJ,GAbE,EAcFjB,KAdE,CAcIC,KAAK,IAAI;AACZC,IAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACH,GAhBE,CAAP;AAiBH,CA3BM,C,CA+BP;;AACA,OAAO,MAAMiB,UAAU,GAAI5B,GAAD,IAAS;AAC/B,QAAMC,GAAG,GAAI,GAAEJ,QAAS,eAAxB;AACI,SAAOM,KAAK,CAACF,GAAD,CAAL,CACNG,IADM,CACDC,GAAG,IAAI;AACTL,IAAAA,GAAG,CAACS,QAAJ,CAAa;AACTD,MAAAA,WAAW,EAAE,IADJ;AAETkB,MAAAA,KAAK,EAAE;AAFE,KAAb;AAIH,GANM,EAONhB,KAPM,CAOAC,KAAK,IAAI;AACZC,IAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACH,GATM,CAAP;AAYP,CAdM","sourcesContent":["// environment configutations\nimport ENV from './../config.js'\nconst API_HOST = ENV.api_host\n\n// Send a request to check if a user is logged in through the session cookie\nexport const checkSession = (app) => {\n    const url = `${API_HOST}/users/check-session`;\n\n    if (!ENV.use_frontend_test_user) {\n        fetch(url)\n        .then(res => {\n            if (res.status === 200) {\n                return res.json();\n            }\n        })\n        .then(json => {\n            if (json && json.currentUser) {\n                app.setState({ currentUser: json.currentUser });\n            }\n        })\n        .catch(error => {\n            console.log(error);\n        });\n    } else {\n        app.setState({ currentUser: ENV.user });\n    }\n    \n};\n\n// A function to send a POST request with the user to be logged in\nexport const login = (loginComp, app) => {\n    const request = new Request(`${API_HOST}/users/login`, {\n        method: \"post\",\n        body: JSON.stringify(loginComp.state),\n        headers: {\n            Accept: \"application/json, text/plain, */*\",\n            \"Content-Type\": \"application/json\"\n        }\n    });\n\n    return fetch(request)\n        .then(res => {\n            console.log(res)\n            if (res.status === 200) {\n                return res.json();\n            }\n        })\n        .then(json => {\n            if (json && json.currentUser) {\n                app.setState({ currentUser: json.currentUser, admin: json.admin });\n                loginComp.setState({ loggedIn: 1 })\n                return \"success\"\n            }\n        })\n        .catch(error => {\n            console.log(error)\n        });\n};\n\n\n\n// Log out user and destroy session\nexport const logoutUser = (app) => {\n    const url = `${API_HOST}/users/logout`;\n        return fetch(url)\n        .then(res => {\n            app.setState({\n                currentUser: null,\n                admin: \"false\"\n            })\n        })\n        .catch(error => {\n            console.log(error);\n        });\n    \n    \n};"]},"metadata":{},"sourceType":"module"}